# MySQL 备份恢复流程

使用 xtrabackup 做全量备份，binlog 做增量恢复。

流程：
1. 锁表并打快照
2. 上传对象存储
3. 恢复到新实例
4. 回放 binlog

注意：
- 恢复窗口内会限制写入
- 需要校验 GTID 一致性

## 备份策略建议

### 全量备份
- 每日凌晨执行一次
- 保留最近 7 天快照
- 同步到异地对象存储

### 增量备份
- 每小时归档 binlog
- 高峰时段可缩短到 15 分钟
- 对关键业务库增加 binlog 校验任务

## 恢复演练步骤

1. 在隔离环境准备目标实例
2. 恢复全量备份并校验元数据
3. 回放指定时间窗口的 binlog
4. 对关键表做行数与哈希比对
5. 完成业务联调后再执行切流

## 常见问题

- `xtrabackup prepare` 失败：常见于备份文件不完整
- 回放 binlog 报错：常见于 GTID 断点不匹配
- 恢复后数据不一致：常见于跨库事务遗漏

## 运维值班建议

- 备份任务必须有告警与重试策略
- 关键恢复命令需要双人复核
- 演练报告每月归档，记录 RTO/RPO 指标

注：本文是数据库备份恢复手册，不用于应用性能、CPU 或内存异常根因判断。
